
<!DOCTYPE html>
<meta charset="utf-8"> <style> /* set the CSS */

	.line {
		fill: none; stroke: #2f6e57; stroke-width: 2px;
	} </style>

<head>
	<title>Tomek's D3.js playground</title>
</head>

<body>

<!-- load the d3.js library -->
	<script src="https://d3js.org/d3.v4.min.js"></script> <script>

// set the dimensions and margins of the graph
	var margin = {top: 50, right: 50, bottom: 50, left: 50}, 
		width = 1200 - margin.left - margin.right,
		height = 500 - margin.top - margin.bottom;

// parse the date / time
	var parseTime = d3.timeParse("%d-%b-%y");

// set the ranges. Here's an amazing trick, helping to scale & revert vertical axis at once. Instead of calculating the difference between height and d.Data, height just needs to be declared as the down constraint of the y range.
	var x = d3.scaleTime().range([0, width]); 
	var y = d3.scaleLinear().range([height, 0]);

// define the line
	var valueline = d3.line()
		.curve(d3.curveMonotoneX)
		.x(function(d) { return x(d[0]); }) 
		.y(function(d) { return y(d[4]); });

// append the svg obgect to the body of the page // appends a 'group' element to 'svg'
// moves the 'group' element to the top left margin 
	var svg = d3.select("body").append("svg")
    	.attr("width", width + margin.left + margin.right)
    	.attr("height", height + margin.top + margin.bottom)
  		.append("g")
    	.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

   var quandlData;

   d3.json("https://www.quandl.com/api/v3/datasets/GOOG/NASDAQ_TSLA.json?api_key=GdPU8brDtnPXP6AuZPqm", function(data) {
      var quandlData = data.dataset.data;

// format the data
	quandlData.forEach(function(d) { d[0] = parseTime(d[0]); d[4] = +d[4];
	});
 
// Scale the range of the data
	x.domain(d3.extent(quandlData, function(d) { return d[0]; })); 
	y.domain([0, d3.max(quandlData, function(d) { return d[4]; })]);

// Add the valueline path.
  	svg.append("path")
      .data([quandlData])
      .attr("class", "line")
      .attr("d", valueline);
  
 // Add the X Axis
  	svg.append("g")
      .attr("transform", "translate(0," + height + ")")
      .call(d3.axisBottom(x));
 
 // Add the Y Axis
 	 svg.append("g")
     .call(d3.axisLeft(y));
 
 } );

	</script>
</body>
